<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<title>GBN</title>
	<meta name="author" content="GBN" />
	<meta name="description" content="Fuck You" />
	<meta name="keywords"  content="GBN" />
	<meta name="Resource-type" content="Document" />

	<!--[if IE]>
		<script type="text/javascript">
			 var console = { log: function() {} };
		</script>
	<![endif]-->

	<link rel="stylesheet" type="text/css" href="base.css" />
	<link rel="stylesheet" type="text/css" href="jquery-ui.min.css" />

	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
	<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.9.1/jquery-ui.min.js"></script>
	<script src="http://cdnjs.cloudflare.com/ajax/libs/moment.js/2.17.1/moment.min.js"></script>
	<script src="http://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.1.0/fullcalendar.min.js"></script>


	<script src="https://www.gstatic.com/firebasejs/3.0.2/firebase.js"></script>

	<link rel="stylesheet" type="text/css" href="http://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.1.0/fullcalendar.min.css" />
	<link rel="stylesheet" type="text/css" href="http://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.1.0/fullcalendar.print.css" />

	<style>
		#map {
			height: 400px;
			width: 100%;
			margin: 0 auto;
		}


	#calendar {
		max-width: 900px;
		margin: 0 auto;
	}


    </style>

	<script type="text/javascript">
		// Initialize Firebase
		var config = {
		    apiKey: "AIzaSyCt8XaH9-kzFDGAnWfWBaQj0SeXYRklciI",
		    authDomain: "gbn-livehouse.firebaseapp.com",
		    databaseURL: "https://gbn-livehouse.firebaseio.com"
		};
		firebase.initializeApp(config);

		$(document).ready(function() {
			firebase.database().ref('calendar').on('child_added', function(data) {
				var events = [];
				events.push(data.val());

				$('#calendar').fullCalendar( 'addEventSource', events );
			});

			firebase.auth().onAuthStateChanged(function(user) {
				if (user) {
					$("#loginSection").hide();
					$("#scheduleSection").show();
				} else {
					$("#loginSection").show();
					$("#scheduleSection").hide();
				}
			});

			$('#calendar').fullCalendar({
		        header: {
					left: 'prev,next today',
					center: 'title',
					right: 'month,agendaWeek,agendaDay,listWeek'
				},
				navLinks: false, // can click day/week names to navigate views
				editable: false,
				eventLimit: false, // allow "more" link when too many events
		    });	

			var inputEmail = $("#inputEmail");
			var inputPassword = $("#inputPassword");

			$("#buttonLogin").click(function() {
				var email = inputEmail.val();
				var password = inputPassword.val();

				firebase.auth().signInWithEmailAndPassword(email, password).catch(function(error) {
					// Handle Errors here.
					var errorCode = error.code;
					var errorMessage = error.message;

					consoloe.log(errorCode + " " + errorMessage);
				});

				inputEmail.val("");
				inputPassword.val("");
			});

			$("#buttonLogout").click(function() {
				firebase.auth().signOut().then(function() {
				}, function(error) {
				});
			});

		    var inputTitle = $("#inputTitle");
			var inputStart = $("#inputStart");
			var inputUrl = $("#inputUrl");

			$("#buttonSubmit").click(function() {
				var title = inputTitle.val();
				var start = inputStart.val();
				var url = inputUrl.val();

				firebase.database().ref('calendar').push().set({
					title: title,
					start: start,
					url: url
				});

				inputTitle.val("");
				inputStart.val("");
				inputUrl.val("");
			});

			$("#inputStart").datepicker();
			$("#inputStart").datepicker("option", "dateFormat", "yy-mm-dd");

			$("#buttonPrev").click(function() {
				$('#calendar').fullCalendar('prev');
			});

			$("#buttonNext").click(function() {
				$('#calendar').fullCalendar('next');
			});
		});
	</script>
</head>
<body>

<div class="wrap">

	<div class="section" id="loginSection">
		<h2>Login</h2>
		<p>
			email: <input type="email" id="inputEmail" />
			password: <input type="password" id="inputPassword" />
			<input type="button" id="buttonLogin" value="login" />
		</p>
	</div>

	<div class="section" id="scheduleSection">
		<p>
			<input type="button" id="buttonLogout" value="logout" />
		</p>
		<p>
			title: <input type="text" id="inputTitle" />
			start: <input type="text" id="inputStart" />
			url: <input type="text" id="inputUrl" />
			<input type="button" id="buttonSubmit" value="submit" />
		</p>
	</div>

	<div class="section">
		<h2>Schedule</h2>
		<input type="bytton" value="prev" id="buttonPrev">
		<input type="bytton" value="next" id="buttonNext">
		<div id='calendar'></div>
	</div>

</div>

<div class="footer">

	<div class="section">
		<span style="display:block; float: left;">GBN</span>
		<span style="display:block; float: right;">010-9182-0749 / leeyuing@gmail.com </span>
	</div>
</div>

</body>
</html>
